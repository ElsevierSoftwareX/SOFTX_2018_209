a:2:{i:0;a:3:{s:10:"sourceFile";s:66:"/var/www/html/plansys/modules/dev/forms/genmodule/DevGenModule.php";s:4:"file";a:456:{i:0;s:5:"<?php";i:1;s:0:"";i:2;s:33:"class DevGenModule extends Form {";i:3;s:23:"    ## MODULE INFO VARS";i:4;s:17:"    public $name;";i:5;s:18:"    public $alias;";i:6;s:17:"    public $path;";i:7;s:22:"    public $classPath;";i:8;s:19:"    public $module;";i:9;s:25:"    public $imports = '';";i:10;s:23:"    public $error = '';";i:11;s:24:"    public $synced = '';";i:12;s:0:"";i:13;s:26:"    ## ACCESS CONTROL VARS";i:14;s:35:"    public $accessType = 'DEFAULT';";i:15;s:33:"    public $defaultRule = 'deny';";i:16;s:27:"    public $rolesRule = [];";i:17;s:27:"    public $usersRule = [];";i:18;s:26:"    public $acSource = '';";i:19;s:0:"";i:20;s:33:"    public function checkSync() {";i:21;s:80:"        $a = trim($this->module->removeIndent($this->module->generateImport()));";i:22;s:47:"        $b = trim($this->module->loadImport());";i:23;s:0:"";i:24;s:44:"//        $diff = TextDiff::compare($a, $b);";i:25;s:33:"        $this->synced = $a != $b;";i:26;s:29:"        return $this->synced;";i:27;s:5:"    }";i:28;s:0:"";i:29;s:37:"    public function create($module) {";i:30;s:35:"        $m = explode(".", $module);";i:31;s:29:"        if (count($m) == 2) {";i:32;s:35:"            $name = lcfirst($m[1]);";i:33;s:47:"            $class = ucfirst($name) . "Module";";i:34;s:95:"            $basePath = $m[0] == "app" ? Setting::getAppPath() : Setting::getApplicationPath();";i:35;s:92:"            $alias = ($m[0] == "app" ? 'app' : 'application') . ".modules.{$name}.{$class}";";i:36;s:94:"            $path = $basePath . DIRECTORY_SEPARATOR . 'modules' . DIRECTORY_SEPARATOR . $name;";i:37;s:71:"            $classPath = $path . DIRECTORY_SEPARATOR . $class . ".php";";i:38;s:0:"";i:39;s:32:"            $this->name = $name;";i:40;s:34:"            $this->alias = $alias;";i:41;s:32:"            $this->path = $path;";i:42;s:42:"            $this->classPath = $classPath;";i:43;s:0:"";i:44;s:45:"            if (!is_file($this->classPath)) {";i:45;s:72:"                $this->module = ModuleGenerator::init($alias, 'create');";i:46;s:45:"                if (is_null($this->module)) {";i:47;s:59:"                    $this->error = 'Failed to create module";i:48;s:36:"Invalid Class Name "' . $name . '"';";i:49;s:24:"                } else {";i:50;s:65:"                    $this->imports = $this->module->loadImport();";i:51;s:17:"                }";i:52;s:20:"            } else {";i:53;s:37:"                $this->module = null;";i:54;s:55:"                $this->error = 'Failed to create module";i:55;s:38:"Module "' . $name . '" already exist';";i:56;s:13:"            }";i:57;s:9:"        }";i:58;s:5:"    }";i:59;s:0:"";i:60;s:30:"    public function delete() {";i:61;s:31:"        $dirPath = $this->path;";i:62;s:171:"        foreach (new RecursiveIteratorIterator(new RecursiveDirectoryIterator($dirPath, FilesystemIterator::SKIP_DOTS), RecursiveIteratorIterator::CHILD_FIRST) as $path) {";i:63;s:108:"            $path->isDir() && !$path->isLink() ? rmdir($path->getPathname()) : unlink($path->getPathname());";i:64;s:9:"        }";i:65;s:24:"        rmdir($dirPath);";i:66;s:5:"    }";i:67;s:0:"";i:68;s:0:"";i:69;s:35:"    public function load($module) {";i:70;s:35:"        $m = explode(".", $module);";i:71;s:44:"        if (count($m) == 2 && $m[1] != '') {";i:72;s:35:"            $name = lcfirst($m[1]);";i:73;s:47:"            $class = ucfirst($name) . "Module";";i:74;s:95:"            $basePath = $m[0] == "app" ? Setting::getAppPath() : Setting::getApplicationPath();";i:75;s:92:"            $alias = ($m[0] == "app" ? 'app' : 'application') . ".modules.{$name}.{$class}";";i:76;s:94:"            $path = $basePath . DIRECTORY_SEPARATOR . 'modules' . DIRECTORY_SEPARATOR . $name;";i:77;s:71:"            $classPath = $path . DIRECTORY_SEPARATOR . $class . ".php";";i:78;s:0:"";i:79;s:32:"            $this->name = $name;";i:80;s:34:"            $this->alias = $alias;";i:81;s:32:"            $this->path = $path;";i:82;s:42:"            $this->classPath = $classPath;";i:83;s:0:"";i:84;s:44:"            if (is_file($this->classPath)) {";i:85;s:70:"                $this->module = ModuleGenerator::init($alias, 'load');";i:86;s:69:"                $this->accessType = $this->module->checkAccessType();";i:87;s:64:"                $this->defaultRule = $this->module->defaultRule;";i:88;s:60:"                $this->rolesRule = $this->module->rolesRule;";i:89;s:60:"                $this->usersRule = $this->module->usersRule;";i:90;s:58:"                $this->acSource = $this->module->acSource;";i:91;s:61:"                $this->imports = $this->module->loadImport();";i:92;s:20:"            } else {";i:93;s:37:"                $this->module = null;";i:94;s:13:"            }";i:95;s:9:"        }";i:96;s:5:"    }";i:97;s:0:"";i:98;s:38:"    public function getControllers() {";i:99;s:35:"        if (isset($this->module)) {";i:100;s:51:"            return $this->module->getControllers();";i:101;s:16:"        } else {";i:102;s:24:"            return null;";i:103;s:9:"        }";i:104;s:5:"    }";i:105;s:0:"";i:106;s:31:"    public function getForm() {";i:107;s:21:"        return array(";i:108;s:45:"            'title'     => 'Generate Module',";i:109;s:33:"            'layout'    => array(";i:110;s:35:"                'name' => '2-cols',";i:111;s:32:"                'data' => array(";i:112;s:36:"                    'col1' => array(";i:113;s:47:"                        'size'        => '200',";i:114;s:46:"                        'sizetype'    => 'px',";i:115;s:48:"                        'type'        => 'menu',";i:116;s:48:"                        'name'        => 'col1',";i:117;s:83:"                        'file'        => 'application.modules.dev.menus.GenModule',";i:118;s:50:"                        'title'       => 'Module',";i:119;s:53:"                        'icon'        => 'fa-empire',";i:120;s:56:"                        'inlineJS'    => 'GenModule.js',";i:121;s:49:"                        'menuOptions' => array(),";i:122;s:22:"                    ),";i:123;s:36:"                    'col2' => array(";i:124;s:49:"                        'type'     => 'mainform',";i:125;s:45:"                        'name'     => 'col2',";i:126;s:42:"                        'sizetype' => '%',";i:127;s:22:"                    ),";i:128;s:18:"                ),";i:129;s:14:"            ),";i:130;s:42:"            'inlineJS'  => 'GenModule.js',";i:131;s:35:"            'includeJS' => array(),";i:132;s:10:"        );";i:133;s:5:"    }";i:134;s:0:"";i:135;s:33:"    public function getFields() {";i:136;s:22:"        return array (";i:137;s:19:"            array (";i:138;s:33:"                'type' => 'Text',";i:139;s:49:"                'value' => '<!-- EMPTY MODULE -->";i:140;s:27:"<div ng-if=\'!model.name\'>";i:141;s:39:"    <div class=\"empty-box-container\">";i:142;s:31:"        <div class=\"message\">";i:143;s:47:"            Please select item on right sidebar";i:144;s:14:"        </div>";i:145;s:10:"    </div>";i:146;s:0:"";i:147;s:8:"</div>',";i:148;s:14:"            ),";i:149;s:19:"            array (";i:150;s:33:"                'type' => 'Text',";i:151;s:97:"                'value' => '<!------------------------- MODULE INFO TAB ------------------------>";i:152;s:47:"<tabset class=\'tab-set\' ng-if=\'model.name\'>";i:153;s:52:"<tab heading=\"Module Info\" select=\'setTab(1)\'>',";i:154;s:14:"            ),";i:155;s:19:"            array (";i:156;s:36:"                'column1' => array (";i:157;s:27:"                    array (";i:158;s:41:"                        'type' => 'Text',";i:159;s:79:"                        'value' => '<column-placeholder></column-placeholder>',";i:160;s:22:"                    ),";i:161;s:27:"                    array (";i:162;s:49:"                        'label' => 'Module Name',";i:163;s:41:"                        'name' => 'name',";i:164;s:47:"                        'type' => 'LabelField',";i:165;s:22:"                    ),";i:166;s:27:"                    array (";i:167;s:50:"                        'label' => 'Module Alias',";i:168;s:42:"                        'name' => 'alias',";i:169;s:47:"                        'type' => 'LabelField',";i:170;s:22:"                    ),";i:171;s:18:"                ),";i:172;s:36:"                'column2' => array (";i:173;s:27:"                    array (";i:174;s:41:"                        'type' => 'Text',";i:175;s:79:"                        'value' => '<column-placeholder></column-placeholder>',";i:176;s:22:"                    ),";i:177;s:27:"                    array (";i:178;s:48:"                        'label' => 'Class Path',";i:179;s:46:"                        'name' => 'classPath',";i:180;s:49:"                        'labelOptions' => array (";i:181;s:58:"                            'style' => 'text-align:left;',";i:182;s:26:"                        ),";i:183;s:47:"                        'type' => 'LabelField',";i:184;s:22:"                    ),";i:185;s:27:"                    array (";i:186;s:54:"                        'label' => 'Module Directory',";i:187;s:41:"                        'name' => 'path',";i:188;s:49:"                        'labelOptions' => array (";i:189;s:58:"                            'style' => 'text-align:left;',";i:190;s:26:"                        ),";i:191;s:47:"                        'type' => 'LabelField',";i:192;s:22:"                    ),";i:193;s:18:"                ),";i:194;s:30:"                'w1' => '50%',";i:195;s:30:"                'w2' => '50%',";i:196;s:40:"                'type' => 'ColumnField',";i:197;s:14:"            ),";i:198;s:19:"            array (";i:199;s:38:"                'showBorder' => 'Yes',";i:200;s:36:"                'column1' => array (";i:201;s:27:"                    array (";i:202;s:41:"                        'type' => 'Text',";i:203;s:79:"                        'value' => '<column-placeholder></column-placeholder>',";i:204;s:22:"                    ),";i:205;s:27:"                    array (";i:206;s:134:"                        'title' => '<i class=\'fa fa-empire\'></i> Import Initialization <span ng-bind-html=\'importStatus\'></span>',";i:207;s:50:"                        'type' => 'SectionHeader',";i:208;s:22:"                    ),";i:209;s:27:"                    array (";i:210;s:53:"                        'label' => 'Generate Import',";i:211;s:50:"                        'buttonType' => 'success',";i:212;s:44:"                        'icon' => 'refresh',";i:213;s:49:"                        'buttonSize' => 'btn-xs',";i:214;s:44:"                        'options' => array (";i:215;s:52:"                            'style' => 'float:right;";i:216;s:29:"margin:-50px -45px 0px 0px;',";i:217;s:92:"                            'href' => 'url:/dev/genModule/genImport?active={params.active}',";i:218;s:97:"                            'confirm' => 'WARNING: Current code will be REPLACED. Are you sure?',";i:219;s:26:"                        ),";i:220;s:47:"                        'type' => 'LinkButton',";i:221;s:22:"                    ),";i:222;s:27:"                    array (";i:223;s:41:"                        'type' => 'Text',";i:224;s:36:"                        'value' => '";i:225;s:47:"<div style=\'margin:-25px -50px -25px -40px;\'>";i:226;s:32:"    <div class=\"source-editor\"";i:227;s:24:"     style=\"width:100%;";i:228;s:20:"     height:400px;\"";i:229;s:31:"     ng-model=\"model.imports\"";i:230;s:31:"     ng-change=\"saveImport()\"";i:231;s:21:"     ng-delay=\"500\"";i:232;s:47:"     ui-ace=\"aceConfig({inline:true})\"></div>";i:233;s:8:"</div>',";i:234;s:22:"                    ),";i:235;s:18:"                ),";i:236;s:36:"                'column2' => array (";i:237;s:27:"                    array (";i:238;s:41:"                        'type' => 'Text',";i:239;s:79:"                        'value' => '<column-placeholder></column-placeholder>',";i:240;s:22:"                    ),";i:241;s:27:"                    array (";i:242;s:79:"                        'title' => '<i class=\'fa fa-cubes\'></i> Controllers',";i:243;s:50:"                        'type' => 'SectionHeader',";i:244;s:22:"                    ),";i:245;s:27:"                    array (";i:246;s:56:"                        'label' => 'Add New Controller',";i:247;s:50:"                        'buttonType' => 'success',";i:248;s:48:"                        'icon' => 'plus-circle',";i:249;s:49:"                        'buttonSize' => 'btn-xs',";i:250;s:44:"                        'options' => array (";i:251;s:52:"                            'style' => 'float:right;";i:252;s:29:"margin:-50px -45px 0px 0px;',";i:253;s:26:"                        ),";i:254;s:47:"                        'type' => 'LinkButton',";i:255;s:22:"                    ),";i:256;s:27:"                    array (";i:257;s:41:"                        'type' => 'Text',";i:258;s:102:"                        'value' => '<table class=\"table table-condensed table-bordered table-small\">";i:259;s:4:"    ";i:260;s:62:"    <tr ng-repeat=\"c in params.controllers track by $index\">";i:261;s:30:"        <td>{{ c.class }}</td>";i:262;s:9:"    </tr>";i:263;s:10:"</table>',";i:264;s:22:"                    ),";i:265;s:18:"                ),";i:266;s:30:"                'w1' => '50%',";i:267;s:30:"                'w2' => '50%',";i:268;s:40:"                'type' => 'ColumnField',";i:269;s:14:"            ),";i:270;s:19:"            array (";i:271;s:33:"                'type' => 'Text',";i:272;s:97:"                'value' => '<!--------------------- ACCESS CONTROL TAB ------------------------->";i:273;s:32:"</tab><tab select=\'setTab(2)\'>";i:274;s:13:"<tab-heading>";i:275;s:54:"Access Control <span ng-bind-html=\'acStatus\'></span>";i:276;s:16:"</tab-heading>',";i:277;s:14:"            ),";i:278;s:19:"            array (";i:279;s:36:"                'column1' => array (";i:280;s:27:"                    array (";i:281;s:41:"                        'type' => 'Text',";i:282;s:79:"                        'value' => '<column-placeholder></column-placeholder>',";i:283;s:22:"                    ),";i:284;s:27:"                    array (";i:285;s:57:"                        'label' => 'Access Control type',";i:286;s:47:"                        'name' => 'accessType',";i:287;s:47:"                        'onLabel' => 'DEFAULT',";i:288;s:47:"                        'offLabel' => 'CUSTOM',";i:289;s:44:"                        'options' => array (";i:290;s:55:"                            'ng-change' => 'saveAC();',";i:291;s:26:"                        ),";i:292;s:49:"                        'type' => 'ToggleSwitch',";i:293;s:22:"                    ),";i:294;s:18:"                ),";i:295;s:36:"                'column2' => array (";i:296;s:27:"                    array (";i:297;s:41:"                        'type' => 'Text',";i:298;s:87:"                        'value' => '<div ng-if=\\"model.accessType == \'DEFAULT\'\\">',";i:299;s:22:"                    ),";i:300;s:27:"                    array (";i:301;s:57:"                        'label' => 'Default Access Rule',";i:302;s:48:"                        'name' => 'defaultRule',";i:303;s:44:"                        'options' => array (";i:304;s:55:"                            'ng-change' => 'saveAC();',";i:305;s:26:"                        ),";i:306;s:49:"                        'labelOptions' => array (";i:307;s:58:"                            'style' => 'text-align:left;',";i:308;s:26:"                        ),";i:309;s:41:"                        'list' => array (";i:310;s:45:"                            'deny' => 'Deny',";i:311;s:47:"                            'allow' => 'Allow',";i:312;s:26:"                        ),";i:313;s:44:"                        'fieldWidth' => '4',";i:314;s:49:"                        'type' => 'DropDownList',";i:315;s:22:"                    ),";i:316;s:27:"                    array (";i:317;s:41:"                        'type' => 'Text',";i:318;s:56:"                        'value' => '<div class=\'info\'>";i:319;s:39:"    <i class=\"fa fa-info-circle\"></i>";i:320;s:57:"    This value will be used when no matching rule</div>',";i:321;s:22:"                    ),";i:322;s:27:"                    array (";i:323;s:41:"                        'type' => 'Text',";i:324;s:44:"                        'value' => '</div>',";i:325;s:22:"                    ),";i:326;s:27:"                    array (";i:327;s:41:"                        'type' => 'Text',";i:328;s:79:"                        'value' => '<column-placeholder></column-placeholder>',";i:329;s:22:"                    ),";i:330;s:18:"                ),";i:331;s:30:"                'w1' => '50%',";i:332;s:30:"                'w2' => '50%',";i:333;s:40:"                'type' => 'ColumnField',";i:334;s:14:"            ),";i:335;s:19:"            array (";i:336;s:33:"                'type' => 'Text',";i:337;s:56:"                'value' => '<!-- DEFAULT ACCESS TYPE -->";i:338;s:49:"<div ng-if=\"model.accessType == \'DEFAULT\'\">',";i:339;s:14:"            ),";i:340;s:19:"            array (";i:341;s:33:"                'type' => 'Text',";i:342;s:64:"                'value' => '<div style=\\"margin:0px -15px\\">',";i:343;s:14:"            ),";i:344;s:19:"            array (";i:345;s:38:"                'showBorder' => 'Yes',";i:346;s:36:"                'column1' => array (";i:347;s:27:"                    array (";i:348;s:41:"                        'type' => 'Text',";i:349;s:79:"                        'value' => '<column-placeholder></column-placeholder>',";i:350;s:22:"                    ),";i:351;s:27:"                    array (";i:352;s:81:"                        'title' => '<i class=\'fa fa-user-md\'></i> Role Access',";i:353;s:50:"                        'type' => 'SectionHeader',";i:354;s:22:"                    ),";i:355;s:27:"                    array (";i:356;s:46:"                        'name' => 'rolesRule',";i:357;s:50:"                        'fieldTemplate' => 'form',";i:358;s:103:"                        'templateForm' => 'application.modules.dev.forms.genmodule.DevGenModuleAccess',";i:359;s:47:"                        'layout' => 'Vertical',";i:360;s:44:"                        'options' => array (";i:361;s:55:"                            'ng-change' => 'saveAC();',";i:362;s:65:"                            'unique' => '[\'role\', \'access\']',";i:363;s:46:"                            'class' => 'flat',";i:364;s:48:"                            'ng-delay' => '500',";i:365;s:26:"                        ),";i:366;s:43:"                        'sortable' => 'No',";i:367;s:53:"                        'singleViewOption' => array (";i:368;s:44:"                            'name' => 'val',";i:369;s:50:"                            'fieldType' => 'text',";i:370;s:46:"                            'labelWidth' => 0,";i:371;s:47:"                            'fieldWidth' => 12,";i:372;s:53:"                            'fieldOptions' => array (";i:373;s:50:"                                'ng-delay' => 500,";i:374;s:30:"                            ),";i:375;s:26:"                        ),";i:376;s:45:"                        'type' => 'ListView',";i:377;s:22:"                    ),";i:378;s:18:"                ),";i:379;s:36:"                'column2' => array (";i:380;s:27:"                    array (";i:381;s:41:"                        'type' => 'Text',";i:382;s:79:"                        'value' => '<column-placeholder></column-placeholder>',";i:383;s:22:"                    ),";i:384;s:27:"                    array (";i:385;s:78:"                        'title' => '<i class=\'fa fa-user\'></i> User Access',";i:386;s:50:"                        'type' => 'SectionHeader',";i:387;s:22:"                    ),";i:388;s:27:"                    array (";i:389;s:46:"                        'name' => 'usersRule',";i:390;s:50:"                        'fieldTemplate' => 'form',";i:391;s:103:"                        'templateForm' => 'application.modules.dev.forms.genmodule.DevGenModuleAccess',";i:392;s:47:"                        'layout' => 'Vertical',";i:393;s:44:"                        'options' => array (";i:394;s:55:"                            'ng-change' => 'saveAC();',";i:395;s:65:"                            'unique' => '[\'user\', \'access\']',";i:396;s:46:"                            'class' => 'flat',";i:397;s:48:"                            'ng-delay' => '500',";i:398;s:26:"                        ),";i:399;s:43:"                        'sortable' => 'No',";i:400;s:53:"                        'singleViewOption' => array (";i:401;s:44:"                            'name' => 'val',";i:402;s:50:"                            'fieldType' => 'text',";i:403;s:46:"                            'labelWidth' => 0,";i:404;s:47:"                            'fieldWidth' => 12,";i:405;s:53:"                            'fieldOptions' => array (";i:406;s:50:"                                'ng-delay' => 500,";i:407;s:30:"                            ),";i:408;s:26:"                        ),";i:409;s:45:"                        'type' => 'ListView',";i:410;s:22:"                    ),";i:411;s:18:"                ),";i:412;s:30:"                'w1' => '50%',";i:413;s:30:"                'w2' => '50%',";i:414;s:30:"                'w3' => '33%',";i:415;s:40:"                'type' => 'ColumnField',";i:416;s:14:"            ),";i:417;s:19:"            array (";i:418;s:33:"                'type' => 'Text',";i:419;s:36:"                'value' => '</div>',";i:420;s:14:"            ),";i:421;s:19:"            array (";i:422;s:33:"                'type' => 'Text',";i:423;s:65:"                'value' => '<hr style=\\"margin:0px -15px;\\"/>',";i:424;s:14:"            ),";i:425;s:19:"            array (";i:426;s:33:"                'type' => 'Text',";i:427;s:55:"                'value' => '<!-- CUSTOM ACCESS TYPE -->";i:428;s:54:"</div><div ng-if=\"model.accessType == \'CUSTOM\'\">',";i:429;s:14:"            ),";i:430;s:19:"            array (";i:431;s:53:"                'title' => 'Access Control Function',";i:432;s:42:"                'type' => 'SectionHeader',";i:433;s:14:"            ),";i:434;s:19:"            array (";i:435;s:33:"                'type' => 'Text',";i:436;s:28:"                'value' => '";i:437;s:33:"<div style=\'margin:0px -15px;\'>";i:438;s:32:"    <div class=\"source-editor\"";i:439;s:24:"     style=\"width:100%;";i:440;s:20:"     height:400px;\"";i:441;s:32:"     ng-model=\"model.acSource\"";i:442;s:27:"     ng-change=\"saveAC()\"";i:443;s:21:"     ng-delay=\"500\"";i:444;s:47:"     ui-ace=\"aceConfig({inline:true})\"></div>";i:445;s:8:"</div>',";i:446;s:14:"            ),";i:447;s:19:"            array (";i:448;s:33:"                'type' => 'Text',";i:449;s:47:"                'value' => '<!-- TAB CLOSER -->";i:450;s:23:"</div></tab></tabset>',";i:451;s:14:"            ),";i:452;s:10:"        );";i:453;s:5:"    }";i:454;s:0:"";i:455;s:1:"}";}s:7:"methods";a:7:{s:9:"checkSync";a:2:{s:4:"line";i:20;s:6:"length";i:8;}s:6:"create";a:2:{s:4:"line";i:29;s:6:"length";i:30;}s:6:"delete";a:2:{s:4:"line";i:60;s:6:"length";i:7;}s:4:"load";a:2:{s:4:"line";i:69;s:6:"length";i:28;}s:14:"getControllers";a:2:{s:4:"line";i:98;s:6:"length";i:7;}s:7:"getForm";a:2:{s:4:"line";i:106;s:6:"length";i:28;}s:9:"getFields";a:2:{s:4:"line";i:135;s:6:"length";i:319;}}}i:1;N;}